# Clover Wallet - Architecture Decision Records (ADR)

이 문서는 프로젝트의 중요한 설계 결정과 그 이유를 기록합니다.

---

## [ADR-001] 프로젝트 기반 기술 스택 확정
*   **날짜**: 2025-12-24
*   **결정**: Kotlin(Spring Boot) 백엔드와 React Native(Expo) 프론트엔드의 모노레포 구조 채택.
*   **이유**: 단일 저장소에서 백엔드와 프론트엔드의 데이터 규격을 즉시 동기화하고, 통합 배포 파이프라인(Render)을 관리하기 위함.

---

## [ADR-002] Expo Web 빌드 가드 및 배포 자동화
*   **날짜**: 2025-12-24
*   **결정**: `pre-commit.sh`에 `npx expo export` 과정을 포함하고, 웹 호환성을 위해 `react-native-maps` 등을 플랫폼별 컴포넌트로 분리.
*   **이유**: 배포 실패 후 디버깅하는 비용을 줄이기 위해, 커밋 전 로컬에서 실제 배포 빌드를 완벽히 재현하여 무결성을 검증하기 위함.
*   **영향**: 커밋 속도는 다소 느려지나, 서버 배포 성공률을 100%에 가깝게 유지 가능.

---

## [ADR-003] AI 인지 프로토콜 v2.1 (Sequential Assimilation) 도입
*   **날짜**: 2025-12-24
*   **결정**: 단일 문서 요약 방식 대신, 여러 핵심 문서를 순차적으로 읽고 자기 객관화 요약을 수행하는 다중 문서 체계 유지.
*   **이유**: AI의 인지 부하를 줄이려는 시도가 오히려 정보 누락과 환각을 초래함을 확인. 인지적 깊이(System 2)를 강제하기 위해 의도적인 불편함(순차 읽기)을 유지함.

---

## [ADR-004] 웹 환경 호환성을 위한 스토리지 추상화 (MMKV 대체)
*   **날짜**: 2025-12-24
*   **결정**: 네이티브 전용 모듈인 `react-native-mmkv`를 사용하는 저장소 로직에 대해 `.web.ts` 확장자를 통한 `localStorage` Mock 구현을 강제함.
*   **이유**: `react-native-mmkv`는 웹 브라우저 생성자가 없어 런타임 에러(`TypeError: t is not a constructor`)를 유발함. Expo의 플랫폼별 파일 참조 기능을 활용하여 네이티브와 웹의 영속성 로직을 분리함.

---

## [ADR-005] Flutter 기반 Pixel-Perfect UI 동기화
*   **날짜**: 2025-12-24
*   **결정**: `archive/flutter_old` 프로젝트를 "진실의 원천"으로 삼고, 색상 HEX, 블러 강도, 그림자, 그라데이션 및 한국어 텍스트를 RN에 1:1로 이식함.
*   **이유**: RN 마이그레이션 과정에서 기존 앱의 프리미엄 감성과 기획 의도가 훼손되는 것을 방지하고 디자인 일관성을 확보하기 위함.

---

## [ADR-007] Lint-Zero 품질 정책 도입
*   **날짜**: 2025-12-24
*   **결정**: 모든 소스 코드의 린트 경고(Warning)를 에러와 동일하게 취급하며, 커밋 전 전수 해결을 의무화함.
*   **이유**: 미사용 변수, 잘못된 Hook 의존성 등이 잠재적인 런타임 에러나 메모리 누수의 원인이 됨을 확인. 코드 베이스의 청결도를 유지하여 장기적인 유지보수 효율을 극대화하기 위함.

---

## [ADR-008] 고정밀 디자인 동기화 (Pixel-Perfect Sync)
*   **날짜**: 2025-12-24
*   **결정**: 단순한 색상 복제를 넘어, 그림자(Shadow)의 블러/오프셋 값, 텍스트의 정밀 두께(900), 그라데이션 좌표값까지 Flutter 원본과 1:1로 일치시킴.
*   **이유**: 프리미엄 감성은 아주 미세한 수치 차이에서 결정되므로, RN에서도 동일한 시각적 무게감을 제공하기 위함.

---

## [ADR-009] 전역 타이포그래피 표준화 (Noto Sans KR)
*   **날짜**: 2025-12-24
*   **결정**: Expo Google Fonts를 사용하여 `Noto Sans KR` (400, 500, 700, 900)을 전역 적용함.
*   **이유**: Flutter 원본의 감성을 완성하는 핵심 요소가 폰트임을 확인. 시스템 폰트 대신 명확한 정체성을 가진 상용 폰트를 사용하여 시각적 완성도를 극대화함.

---

## [ADR-010] 시그니처 레이아웃 및 고품질 에셋 복원
*   **날짜**: 2025-12-24
*   **결정**: Flutter의 `centerDocked` FAB 레이아웃을 RN에서 커스텀 탭바 컴포넌트로 완벽 재현하고, 단순 아이콘 대신 피그마 스타일의 복합 SVG 일러스트를 사용함.
*   **이유**: 앱의 프리미엄 브랜드 아이덴티티는 독특한 레이아웃과 고해상도 에셋에서 기인함을 확인. 기획서의 의도를 100% 복원하기 위함.

---

## [ADR-011] 실 배포 환경 기반 엔드포인트 및 가드 무결성 강화
*   **날짜**: 2025-12-25
*   **결정**: 커스텀 도메인 장애에 대비하여 작동이 확인된 Render 전용 백엔드 URL(`onrender.com`)을 프론트엔드 기본 엔드포인트로 설정함. 또한, NativeWind v4 호환성을 위해 Tailwind CSS v3를 유지하고 가드(`pre_commit.sh`)의 정규표현식 오작동을 수정함.
*   **이유**: 배포 초기 단계에서 도메인 연결 불안정성을 배제하고, 실제 통신 가능한 상태를 유지하기 위함. 또한 툴링(Tailwind/Linter)의 기술적 제약 사항을 명확히 하고 가드 자체의 신뢰도를 높이기 위함.