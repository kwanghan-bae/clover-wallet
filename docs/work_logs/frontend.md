# Clover Lotto 앱 (Frontend) 개발 작업 일지

## 1. 작업 개요

Clover Lotto 기획서를 바탕으로 React Native 앱의 MVP(최소 기능 제품) 버전을 개발합니다.

---

## 2. 상세 작업 내역

### 2.1. React Native 앱 초기 설정 및 구조화 (Commit: `28e8aa8`)

- **기본 구조 설정:** 기존의 지갑 예제 코드를 모두 삭제하고, 로또 앱을 위한 새로운 기본 구조를 설정했습니다.
- **하단 네비게이션 구현:** 기획서에 따라 홈, 내 번호, 명당, 커뮤니티의 4개 주요 섹션으로 구성된 하단 네비게이션 바를 추가했습니다.
- **화면 생성:** 각 탭에 해당하는 빈 화면 (`HomeScreen`, `MyNumbersScreen`, `LuckySpotsScreen`, `CommunityScreen`)을 생성하여 앞으로의 개발을 위한 기반을 마련했습니다.
- **빌드 환경 개선:** 오래된 Gradle 설정으로 인해 발생하던 Java 버전 호환성 문제를 해결했습니다. (Android Gradle Plugin 8.2.0, Gradle 8.4, Kotlin 1.9.23)

### 2.2. 홈 화면 - 랜덤 로또 번호 생성 기능 (Commit: `37991d9`)

- **기능 구현:** 홈 화면에 '번호 생성' 버튼을 추가하고, 버튼 클릭 시 1~45 사이의 고유한 6개 숫자를 랜덤으로 생성하는 기능을 구현했습니다.
- **UI/UX:** 생성된 번호는 정렬 후, 숫자 범위에 따라 다른 색상의 원으로 시각화하여 보여주도록 UI를 개선했습니다.

### 2.3. 내 번호 화면 - 수동 번호 입력 및 조회 (Commit: `37991d9`)

- **기능 구현:** '내 번호' 화면에 로또 번호 6개와 회차를 직접 입력하고 저장할 수 있는 폼을 추가했습니다.
- **상태 관리:** 입력된 번호는 리스트에 추가되어 화면 하단에 표시되며, 간단한 유효성 검사(1-45 범위, 중복 여부) 로직을 포함했습니다.

### 2.4. React Native 앱 - 당첨 확인 API 연동 (Commit: `5eaaeaa`)

- **API 연동:** '내 번호' 화면에 '당첨 확인' 버튼을 추가하여 백엔드 API 호출을 트리거하도록 구현했습니다.
- **서비스 및 모델 생성:** API 통신을 담당하는 `LottoApiService`와 응답 데이터를 파싱하기 위한 `LottoWinnings` 데이터 모델을 생성했습니다.
- **비동기 처리:** `FutureBuilder`를 사용하여 비동기적으로 API 결과를 받아와 화면에 당첨 내역(더미 데이터)을 표시하도록 구현했습니다.

### 2.5. 커뮤니티 화면 - 기본 UI 구현 (Commit: `71814a0`)

- **UI 구현:** 커뮤니티 화면에 더미 데이터를 사용하여 게시물 목록을 표시하는 기본 UI를 구현했습니다.
- **컴포넌트:** 각 목록 항목에는 제목, 작성자, 작성일이 표시되며, 새 글 작성을 위한 플로팅 액션 버튼을 추가했습니다.
- **모델 생성:** 게시물 데이터를 위한 `Post` 모델을 생성했습니다.

### 2.6. 내 번호 화면 데이터 영속성 구현 (shared_preferences) (Commit: `33f7afd`)

- **데이터 영속성 구현:** `shared_preferences` 패키지를 사용하여 '내 번호' 화면에서 사용자가 입력한 로또 번호 목록을 로컬에 저장하고 불러오는 기능을 구현했습니다.
- **로직 추가:** `MyNumbersScreen`의 `initState`에서 저장된 데이터를 로드하고, `_saveNumbers` 호출 시 데이터를 저장하도록 로직을 추가했습니다.

### 2.7. 커뮤니티 기능 구현 및 리팩토링 (Provider)

- **프론트엔드 구현:**
    - API와 연동하여 게시물 목록을 불러오는 기능을 구현했습니다.
    - 새 게시물을 작성하고 서버에 전송하는 `CreatePostScreen`을 구현했습니다.
- **상태관리 리팩토링:**
    - 기존의 `setState` 기반 상태 관리를 `Provider` 패턴으로 리팩토링했습니다.
    - `CommunityViewModel`을 생성하여 API 호출 및 상태(로딩, 데이터, 에러) 관리를 위임했습니다.
- **테스트 코드 작성:** `CommunityApiService`와 `CommunityViewModel`에 대한 단위 테스트를 작성하여 기능의 안정성을 확보했습니다.
- **빌드 환경 개선:** Android `compileSdkVersion`을 34로 업데이트하고, Kotlin 버전 불일치 경고를 해결하기 위해 Gradle 설정을 수정했습니다.

### 2.8. 배포 안정성 확보 및 빌드 가드(Build Guard) 강화

- **배포 에러 해결:**
    - Render 배포 시 발생하던 `Cannot resolve entry file` 에러를 진입점(`index.js`) 명시 및 `package.json` 수정을 통해 해결했습니다.
    - 웹 환경에서 `react-native-maps` 참조 시 발생하는 빌드 오류를 플랫폼별 컴포넌트 분리(`.web.tsx`) 및 Mock 구현으로 해결했습니다.
- **의존성 정규화:**
    - Reanimated v4 구동에 필수적인 `react-native-worklets` 및 아이콘 렌더링을 위한 `react-native-svg` 누락을 확인하고 설치했습니다.
    - `jest.setup.js`의 잘못된 모듈 경로를 수정하여 테스트 환경을 정상화했습니다.
- **빌드 가드(pre-commit) 고도화:**
    - `pre_commit.sh`에 실제 `expo export` 빌드 검증 로직을 안착시켜, 코드 커밋 전 배포 성공 가능성을 100% 검증하도록 개선했습니다.
    - 파일 삭제 등 특정 상황에서 발생하던 스크립트 오류를 수정했습니다.

### 2.9. 웹 런타임 에러 해결 및 스토리지 추상화

- **런타임 에러 해결:**
    - 배포 후 발생하던 `Uncaught TypeError: t is not a constructor` 에러가 네이티브 전용 모듈인 `react-native-mmkv` 호출에서 기인함을 확인했습니다.
    - `storage.web.ts`를 구현하여 브라우저 환경에서는 `localStorage`를 사용하도록 추상화 레이어를 추가했습니다.
- **플랫폼 대응:**
    - Expo의 플랫폼별 확장자(`*.web.ts`) 시스템을 활용하여 코드 수정 없이 빌드 타겟에 따라 최적화된 저장소 엔진이 선택되도록 구조화했습니다.

### 2.10. 디자인 정밀 동기화 및 안정성 강화 (v1.1)

- **Pixel-Perfect 디자인 이식:**
    - Flutter의 `theme.dart`에서 추출한 HEX 컬러를 Tailwind에 반영하고, `LinearGradient`를 통한 입체감 있는 UI를 복구했습니다.
    - 모든 아이콘을 `Clover` 테마에 맞춰 Lucide 아이콘으로 교체했습니다.
- **안정성 도구 도입:**
    - `zod` 라이브러리를 도입하여 API 응답 규격을 입구에서 검증함으로써 데이터 불일치로 인한 뒤늦은 크래시를 차단했습니다.
    - `GlobalErrorBoundary`를 적용하여 예상치 못한 런타임 에러 발생 시 화이트아웃 대신 복구 가이드를 제공하도록 조치했습니다.
- **품질 확보:**
    - 통계 계산, API 언래핑 등 핵심 비즈니스 로직에 대한 15개 단위 테스트를 완료하여 로직 정합성을 증명했습니다.

---

## 3. TODO 리스트 (향후 개발 계획)

### 3.1. MVP 기능 고도화
-   [ ] **푸시 알림 (프론트엔드):**
    -   [ ] Firebase Cloud Messaging(FCM) 등 푸시 서비스를 연동.
    -   [ ] 당첨 시 사용자에게 푸시 알림을 받는 기능 구현.
-   [x] **커뮤니티 기능 확장:**
    -   [x] 게시물 목록 조회 및 작성 기능 구현 (UI).
    -   [ ] 게시물 상세 보기 화면 구현.
    -   [ ] 게시물 수정, 삭제 기능 구현.
    -   [ ] 댓글 기능 추가.
-   [x] **데이터 영속성:**
    -   [x] '내 번호' 목록을 앱 재시작 후에도 유지되도록 로컬 저장소(`shared_preferences`)에 저장.
-   [x] **상태관리 리팩토링:**
    -   [x] `Provider`를 도입하여 `Community` 기능의 상태 관리 구조 개선.

### 3.2. 2단계 기능 개발
-   [ ] **OCR 기반 로또 용지 스캔**
-   [ ] **전국 로또 명당 찾기 (지도 연동 화면)**
-   [ ] **구입 내역 기반 뱃지 시스템 (UI)**

### 3.3. 3단계 및 기타
-   [ ] **로또 명당 연계 여행 플랜 추천 (UI)**
-   [ ] **전반적인 UI/UX 개선 및 애니메이션 추가.**
-   [x] **단위 테스트 및 통합 테스트 코드 작성:**
    -   [x] `CommunityApiService`, `CommunityViewModel` 단위 테스트 코드 작성.
